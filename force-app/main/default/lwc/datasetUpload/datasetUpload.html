<template>
    <lightning-card title="Dataset upload (Step 1)">
       <div class="slds-m-around_medium">
           <div class="slds-align_absolute-center slds-m-bottom_medium">
                <lightning-button class="slds-align-middle" label="Create new Dataset" slot="actions" icon-name="utility:add" onclick={handleNewDataset}></lightning-button>
                <p class="slds-m-horizontal_medium">Or</p>
                <lightning-combobox
                    value={selectedDataset}
                    options={datasetOptions}
                    onchange={handleDatasetChange}
                    variant="label-hidden"
                    placeholder="Select existing Dataset"
                    >
                </lightning-combobox>
           </div>
           <lightning-spinner if:true={tableIsLoading} alternative-text="Loading" size="large"></lightning-spinner>
           <template if:true={rows}>
           <table class="slds-table slds-table_cell-buffer slds-table_bordered" aria-labelledby="element-with-table-label other-element-with-table-label" if:false={tableIsLoading}>
               <thead>
                   <tr class="slds-line-height_reset">
                       <th class="" scope="col">
                           <div class="slds-truncate" title="System Context">System Context</div>
                       </th>
                       <th class="" scope="col">
                           <div class="slds-truncate" title="User Prompt">User Prompt</div>
                       </th>
                       
                       <th class="" scope="col">
                           <div class="slds-truncate" title="Assistant Response">Assistant Response</div>
                       </th>
                       <th class="" scope="col">
                           <div class="slds-truncate" title="Stage">Action</div>
                       </th>
                   </tr>
               </thead>
               <tbody>
                   <template for:each={rows} for:item="row">
                       <tr class="inputRows" key={row.Id}>
                           <th data-label="System Context" scope="row">
                               <lightning-textarea message-when-value-missing="Please enter value" value={row.SystemMsg} data-rowid={row.Id} data-rol="SystemMsg" onchange={handleChange}></lightning-textarea>
                           </th>
                           <td data-label="User Prompt">
                               <lightning-textarea message-when-value-missing="Please enter value" value={row.UserMsg} data-rowid={row.Id} data-rol="UserMsg" onchange={handleChange}></lightning-textarea>
                              
                           </td>
                           <td data-label="Assistant Response">
                               <lightning-textarea message-when-value-missing="Please enter value" value={row.AssistantMsg} data-rowid={row.Id} data-rol="AssistantMsg"  onchange={handleChange}></lightning-textarea>
                           </td>
                           <td data-label="Delete row">
                               <lightning-button-icon icon-name="action:delete"  alternative-text="Delete" title="Delete" data-id={row.Id} onclick={deleteRow}></lightning-button-icon>
                           </td>
                       </tr>
                   </template>
               </tbody>
           </table>
           <lightning-button class="slds-align_absolute-center slds-m-bottom_medium" label="Add Row" slot="actions" icon-name="utility:add" onclick={addRow}></lightning-button>
           <div class="slds-align_absolute-center">
            
            <div>
                <lightning-button variant="brand" label="Save File" onclick={handleSaveFile}></lightning-button>
                <lightning-button class="slds-m-left_small" variant="brand" label="Upload File" onclick={handleUploadFile}></lightning-button>
            </div>
               <p if:true={showRowsInfo} class="slds-m-left_small">{rowsInfoMessage}</p>
               <lightning-spinner if:true={uploadFileisLoading} alternative-text="Loading" size="medium" class="spinner"></lightning-spinner>
           </div>
        </template>
       </div>    
   </lightning-card>
</template>