<template>
    <lightning-card title="AI Chat">
        <div class="slds-m-top_large slds-m-bottom_x-large slds-m-horizontal_x-small">
            <div class="chat-container">
                <template if:true={messages}>
                    <ul class="message-list overflow">
                        <template for:each={messages} for:item="message">
                            <li key={message.Id} class="message-item">
                                <pre class="message-box user-box">
                                    {message.Content}
                                </pre>
                                <pre class="message-box system-box">
                                    {message.Response}
                                </pre>
                            </li>    
                        </template>
                    </ul>
                </template>
            </div>
            <div style="display:flex">
                <lightning-accordion class="example-accordion" allow-multiple-sections-open onsectiontoggle={handleToggleSection} 
                active-section-name={sectionName}>
                    <lightning-accordion-section name="AdvancedSettings" label="Advanced settings">
                        <div>
                            <lightning-slider class="slider" label="Temperature" min="0" max="2" step="0.01" size="x-small" value={temperatureValue} onchange={handleSliderChange}></lightning-slider>
                            <lightning-helptext content="Lower values for temperature result in more consistent outputs, while higher values generate more diverse and creative results. Select a temperature value based on the desired trade-off between coherence and creativity"></lightning-helptext>
                        </div>
                    </lightning-accordion-section>
              
            </lightning-accordion> 
    
            <lightning-accordion class="example-accordion" allow-multiple-sections-open onsectiontoggle={handleToggleSection} 
                active-section-name={sectionName}>
                    <lightning-accordion-section name="DocumentActions" label="Document Actions">
                        <div>
                           <lightning-button variant="brand-outline" label="Send to document" onclick={handleSendToDocument}></lightning-button>
                        </div>
                    </lightning-accordion-section>
              
            </lightning-accordion> 
            </div>
           
            
            <div class="slds-p-around_medium lgc-bg containerInputPrompt" onkeypress={handleEnter}>
                <lightning-textarea type="text" value ={prompt} label="Enter your prompt" placeholder="" onchange={handleInputChange} class="inputPrompt"></lightning-textarea>
                <template if:false={responseIsLoading}>
                    <lightning-button-icon icon-name="utility:enter"  alternative-text="Send prompt" title="Send prompt" onclick={handleButtonClick}></lightning-button-icon>
                </template>  
            </div>
            <div style="display:flex">
                <template if:true={responseIsLoading}>
                    <div style="position:relative;margin-left:35px">
                        <lightning-spinner size="small" alternative-text="Loading"></lightning-spinner>
                    </div> 
                </template>

            </div> 
            <p>
                {response}
            </p>
        </div>
    
    </lightning-card>
  
</template>